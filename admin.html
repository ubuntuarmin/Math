<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Admin | Katy Math</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="style.css" />
</head>
<body class="page">
  <!-- Top bar -->
  <header class="site-header">
    <nav class="navbar">
      <a href="index.html" class="navbar-brand">
        <span class="navbar-brand-logo"></span>
        <span>Katy Math Admin</span>
      </a>
      <div class="navbar-nav">
        <a
          href="index.html"
          class="px-3 py-1.5 rounded-full text-xs font-medium text-gray-300 hover:text-white hover:bg-white/5 transition whitespace-nowrap"
        >
          ← Back to App
        </a>
      </div>
    </nav>
  </header>

  <main>
    <div class="container">
      <section class="surface">
        <!-- HEADER -->
        <header class="mb-6 flex flex-col md:flex-row md:items-center md:justify-between gap-4">
          <div>
            <span class="badge">Admin Console</span>
            <h1>Students & Leaderboard</h1>
            <p class="text-sm text-gray-400 max-w-xl">
              Manage users, reset the weekly leaderboard, and review suggestions,
              link submissions, and activity from students. Only the configured
              admin account can access this page.
            </p>
          </div>
          <div class="flex flex-col items-start md:items-end gap-2">
            <button
              id="resetLeaderboardBtn"
              type="button"
              class="bg-red-600/80 hover:bg-red-500 text-white text-xs font-bold uppercase tracking-[0.16em] px-4 py-2 rounded-full shadow-lg"
            >
              Reset Leaderboard & Distribute Rewards
            </button>
            <p class="text-[10px] text-gray-500 max-w-xs text-right">
              This will award credits to the weekly top 10, send notifications,
              and reset all students' weekly minutes.
            </p>
          </div>
        </header>

        <!-- USER SEARCH -->
        <div class="mb-4 flex flex-col md:flex-row md:items-center md:justify-between gap-3">
          <div class="text-xs text-gray-400 uppercase tracking-[0.16em] font-bold">
            Students
          </div>
          <div class="flex items-center gap-2 w-full md:w-auto">
            <input
              id="adminSearch"
              type="text"
              placeholder="Search by name or email..."
              class="w-full md:w-64 bg-gray-900 p-2 rounded border border-gray-700 text-sm text-gray-200 outline-none focus:border-blue-500"
            />
          </div>
        </div>

        <!-- STUDENT TABLE -->
        <div class="table-wrapper mb-10">
          <table class="w-full text-sm">
            <thead>
              <tr class="bg-gray-900/70 text-xs text-slate-400 uppercase tracking-widest">
                <th class="p-3 text-left">Name</th>
                <th class="p-3 text-left">Email</th>
                <th class="p-3 text-left">Grade</th>
                <th class="p-3 text-left">Credits</th>
                <th class="p-3 text-left">This Week (min)</th>
                <th class="p-3 text-right">Actions</th>
              </tr>
            </thead>
            <tbody id="adminUserList">
              <tr>
                <td colspan="6" class="p-10 text-center text-white">
                  Loading Students...
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- SUGGESTIONS SECTION -->
        <section class="mt-8">
          <header class="mb-4 flex flex-col md:flex-row md:items-center md:justify-between gap-3">
            <div>
              <div class="text-xs text-gray-400 uppercase tracking-[0.16em] font-bold">
                Suggestions & Bug Reports
              </div>
              <p class="text-xs text-gray-500 max-w-xl">
                Students spend <span class="font-semibold text-emerald-300">20 credits</span>
                to submit a suggestion. If you approve it, refund their 20 credits and optionally
                give bonus tokens for especially helpful feedback.
              </p>
            </div>
            <div class="text-[10px] text-gray-500 italic">
              Tip: Tell students they can earn extra credits for good bug reports or ideas.
            </div>
          </header>

          <div class="table-wrapper mb-10">
            <table class="w-full text-sm">
              <thead>
                <tr class="bg-gray-900/70 text-xs text-slate-400 uppercase tracking-widest">
                  <th class="p-3 text-left">Suggestion</th>
                  <th class="p-3 text-left">Type</th>
                  <th class="p-3 text-left">User</th>
                  <th class="p-3 text-left">Status</th>
                  <th class="p-3 text-right">Review</th>
                </tr>
              </thead>
              <tbody id="suggestionList">
                <tr>
                  <td colspan="5" class="p-6 text-center text-slate-400 text-sm">
                    Loading suggestions...
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </section>

        <!-- LINK SUBMISSIONS SECTION -->
        <section class="mt-8">
          <header class="mb-4 flex flex-col md:flex-row md:items-center md:justify-between gap-3">
            <div>
              <div class="text-xs text-gray-400 uppercase tracking-[0.16em] font-bold">
                Link Submissions
              </div>
              <p class="text-xs text-gray-500 max-w-xl">
                Students can submit resource links from the Suggestions page. Approving a link
                and adding it to your system should reward the student with
                <span class="font-semibold text-emerald-300">150 credits</span>.
              </p>
            </div>
            <div class="text-[10px] text-gray-500 italic">
              Tip: Only approve links that are safe, school-appropriate, and useful for math.
            </div>
          </header>

          <div class="table-wrapper">
            <table class="w-full text-sm">
              <thead>
                <tr class="bg-gray-900/70 text-xs text-slate-400 uppercase tracking-widest">
                  <th class="p-3 text-left">Link</th>
                  <th class="p-3 text-left">User</th>
                  <th class="p-3 text-left">Status</th>
                  <th class="p-3 text-right">Review</th>
                </tr>
              </thead>
              <tbody id="linkSubmissionList">
                <tr>
                  <td colspan="4" class="p-6 text-center text-slate-400 text-sm">
                    Loading link submissions...
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </section>
      </section>
    </div>
  </main>

  <footer class="site-footer">
    <div class="site-footer-inner">
      <span>© 2026 Katy Math</span>
      <span>Admin Panel</span>
    </div>
  </footer>

  <!-- Scripts -->
  <script type="module" src="./js/firebase.js"></script>
  <script type="module" src="./js/admin.js"></script>
</body>
</html>
